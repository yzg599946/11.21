"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _conf=_interopRequireDefault(require("../../conf")),_xeUtils=_interopRequireDefault(require("xe-utils")),_msgQueue=_interopRequireDefault(require("./msgQueue"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var _default2={name:"VxeMessage",props:{value:Boolean,id:String,type:String,status:String,top:{type:Number,default:15},title:String,duration:{type:Number,default:function(){return _conf.default.message.duration}},message:[String,Function],lockView:{type:Boolean,default:function(){return _conf.default.message.lockView}},lockScroll:{type:Boolean,default:function(){return _conf.default.message.lockScroll}},mask:{type:Boolean,default:function(){return _conf.default.message.mask}},maskClosable:Boolean,zIndex:{type:Number,default:function(){return _conf.default.message.zIndex}},animat:{type:Boolean,default:function(){return _conf.default.message.animat}}},data:function(){return{visible:!1,contentVisible:!1,beforeLockStyle:null,msgTop:0}},computed:{vSize:function(){return this.size||this.$parent&&(this.$parent.size||this.$parent.vSize)},isMsg:function(){return"message"===this.type}},watch:{value:function(e){this[e?"open":"close"]()}},created:function(){this.value&&this.open()},mounted:function(){document.body.appendChild(this.$el)},beforeDestroy:function(){this.removeMsgQueue(),this.$el.parentNode.removeChild(this.$el)},render:function(e){var t,i=this.vSize,s=this.type,n=this.animat,o=this.zIndex,l=this.status,u=this.msgTop,a=this.contentVisible,c=this.visible,r=this.title,f=this.message,d=this.lockView,h=this.mask,m=this.isMsg;return e("div",{class:["vxe-msg--wrapper","type--".concat(s),(t={},_defineProperty(t,"size--".concat(i),i),_defineProperty(t,"msg--".concat(l),l),_defineProperty(t,"is--animat",n),_defineProperty(t,"lock--view",d),_defineProperty(t,"is--mask",h),_defineProperty(t,"is--visible",a),_defineProperty(t,"active",c),t)],style:{zIndex:o,top:u?"".concat(u,"px"):u},on:{click:this.selfClickEvent}},[e("div",{class:"vxe-msg--box",ref:"msgBox"},[m?null:e("div",{class:"vxe-msg--header"},[e("span",{class:"vxe-msg--title"},r||_conf.default.i18n("vxe.alert.title")),e("i",{class:["vxe-msg--close-btn",_conf.default.icon.msgClose],on:{click:this.closeEvent}})]),e("div",{class:"vxe-msg--body"},[l?e("div",{class:"vxe-msg--status-wrapper"},[e("i",{class:["vxe-msg--status-icon",_conf.default.icon["msg".concat(l.replace(/\b(\w)/,function(e){return e.toUpperCase()}))]]})]):null,e("div",{class:"vxe-msg--content"},this.$slots.default||(_xeUtils.default.isFunction(f)?f.call(this,e):f))]),m?null:e("div",{class:"vxe-msg--footer"},["confirm"===s?e("vxe-button",{on:{click:this.cancelEvent}},_conf.default.i18n("vxe.button.cancel")):null,e("vxe-button",{props:{type:"primary"},on:{click:this.confirmEvent}},_conf.default.i18n("vxe.button.confirm"))])])])},methods:{selfClickEvent:function(e){if(this.maskClosable&&e.target===this.$el){this.close("mask")}},closeEvent:function(e){var t="close";this.$emit(t,e),this.close(t)},confirmEvent:function(e){var t="confirm";this.$emit(t,e),this.close(t)},cancelEvent:function(e){var t="cancel";this.$emit(t,e),this.close(t)},open:function(){var e=this,t=this.duration,i=this.visible,s=this.lockScroll,n=this._handleCustom,o=this.isMsg;if(!i){if(this.visible=!0,this.contentVisible=!1,setTimeout(function(){e.contentVisible=!0},10),s){var l=document.body;this.beforeLockStyle={paddingRight:l.style.paddingRight,overflow:l.style.overflow},l.style.paddingRight="".concat(window.innerWidth-(document.documentElement.clientWidth||document.body.clientWidth),"px"),l.style.overflow="hidden"}n||(this.$emit("input",!0),this.$emit("show")),o&&(this.addMsgQueue(),setTimeout(this.close,t))}},addMsgQueue:function(){-1===_msgQueue.default.indexOf(this)&&_msgQueue.default.push(this),this.updateStyle()},removeMsgQueue:function(){var t=this;-1<_msgQueue.default.indexOf(this)&&_xeUtils.default.remove(_msgQueue.default,function(e){return e===t}),this.updateStyle()},updateStyle:function(){this.$nextTick(function(){var i=0;_msgQueue.default.forEach(function(e,t){i+=e.top,e.msgTop=i,i+=e.$refs.msgBox.clientHeight})})},close:function(e){var t=this,i=this.visible,s=this.lockScroll,n=this.beforeLockStyle,o=this.isMsg;i&&(o&&this.removeMsgQueue(),this.contentVisible=!1,setTimeout(function(){t.visible=!1,s&&Object.assign(document.body.style,n),t._handleCustom?t._handleCustom(e):(t.$emit("input",!1),t.$emit("hide",e))},200))}}};exports.default=_default2;