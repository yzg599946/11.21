"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _table=_interopRequireDefault(require("../../table"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var l=null!=arguments[e]?arguments[e]:{},n=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),n.forEach(function(e){_defineProperty(t,e,l[e])})}return t}function _defineProperty(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var excelContextMenu={header:{options:[[{code:"exportAll",name:"隐藏列"},{code:"exportAll",name:"取消所有隐藏"}]]},body:{options:[[{code:"clip",name:"剪贴"},{code:"copy",name:"复制"},{code:"paste",name:"粘贴"}],[{code:"insert",name:"插入"},{code:"remove",name:"删除"},{code:"clearData",name:"清除内容"}],[{code:"sort",name:"排序",children:[{code:"clearSort",name:"清除排序"},{code:"sortAsc",name:"升序"},{code:"sortDesc",name:"倒序"}]}],[{code:"exportAll",name:"导出数据.csv"}]]}},methods={},excelEditConfig={trigger:"dblclick",mode:"cell",showIcon:!1,showStatus:!1};function buildColumns(t,e){return e?e.map(function(e){return t("vxe-table-column",{props:e},buildColumns(t,e.children))}):[]}function buildProps(e,t){var l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=l.editConfig,o=l.contextMenu;return Object.assign({},l,{border:!0,resizable:!0,showOverflow:null,headerCellClassName:t.handleHeaderCellClassName,cellClassName:t.handleCellClassName,contextMenu:Object.assign({},o,excelContextMenu),mouseConfig:{selected:!0,checked:!0},keyboardConfig:{isArrow:!0,isDel:!0,isTab:!0,isCut:!0,isEdit:!0},editConfig:n?Object.assign({},excelEditConfig,n):excelEditConfig})}Object.keys(_table.default.methods).forEach(function(e){methods[e]=function(){return this.$refs.xTable[e].apply(this.$refs.xTable[e],arguments)}});var _default={name:"VxeExcel",props:_objectSpread({columns:Array},_table.default.props),data:function(){return{excelStore:{uploadRows:[]}}},render:function(e){return e("vxe-table",{class:"vxe-excel",props:buildProps(e,this,this.$props),on:_objectSpread({},this.$listeners,{"cell-click":this.cellClickEvent,"header-cell-click":this.headerCellClickEvent,"context-menu-click":this.contextMenuClickEvent}),ref:"xTable"},buildColumns(e,this.columns))},methods:_objectSpread({},methods,{handleHeaderCellClassName:function(e){var t=e.column,l=e.columnIndex,n=e.$table.editStore,o=n.selected,r=n.actived;if(0<l&&(o.column===t||r.column===t))return"vxe-excel--column-selected"},handleCellClassName:function(e){var t=e.row,l=(e.column,e.columnIndex),n=e.$table.editStore,o=n.selected,r=n.actived;if(0===l&&(o.row===t||r.row===t))return"vxe-excel--index-selected"},cellClickEvent:function(e,t){var l=e.row,n=e.rowIndex,o=e.columnIndex,r=e.$table,c=r.$refs,a=r.visibleColumn,s=r.handleSelected,d=r.handleChecked;if(0===o){o+=1;var i=c.tableBody.$el,u=a[o],b=i.querySelectorAll(".vxe-body--row")[n].querySelector(".".concat(u.id));s({row:l,rowIndex:n,column:u,columnIndex:o,cell:b,$table:r},t).then(function(){d({rowIndex:n,columnIndex:o},{rowIndex:n,columnIndex:a.length-1},t)})}},headerCellClickEvent:function(e,t){var l=e.column,n=e.columnIndex,o=e.$table,r=o.$refs,c=o.tableData,a=o.handleSelected,s=o.handleChecked;if(c.length){var d=r.tableBody.$el,i=c[0],u=d.querySelectorAll(".vxe-body--row")[0].querySelector(".".concat(l.id));a({row:i,rowIndex:0,column:l,columnIndex:n,cell:u,$table:o},t).then(function(){s({rowIndex:0,columnIndex:n},{rowIndex:c.length-1,columnIndex:n},t)})}},contextMenuClickEvent:function(e,t){var l=e.menu,n=e.row,o=e.column,r=this.$refs.xTable,c=o.property;switch(l.code){case"clip":r.handleCopyed(!0,t);break;case"copy":r.handleCopyed(!1,t);break;case"paste":r.handlePaste(t);break;case"insert":r.insertAt({},n);break;case"remove":r.remove(n);break;case"clearData":r.clearData(n,c);break;case"clearFilter":r.clearFilter();break;case"clearSort":r.clearSort();break;case"sortAsc":r.sort(c,"asc");break;case"sortDesc":r.sort(c,"desc");break;case"exportAll":r.exportCsv({isHeader:!1})}}})};exports.default=_default;