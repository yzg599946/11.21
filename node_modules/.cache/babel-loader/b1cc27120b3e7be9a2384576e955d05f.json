{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\src\\views\\system\\role.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\src\\views\\system\\role.vue","mtime":1563004622126},{"path":"C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\yet\\project\\longhuiteng_management_system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"C:\\\\Users\\\\Administrator\\\\Desktop\\\\yet\\\\project\\\\longhuiteng_management_system\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"vant/es/search/style\");\n\nvar _search = _interopRequireDefault(require(\"vant/es/search\"));\n\nrequire(\"vant/es/action-sheet/style\");\n\nvar _actionSheet = _interopRequireDefault(require(\"vant/es/action-sheet\"));\n\nrequire(\"vant/es/toast/style\");\n\nvar _toast = _interopRequireDefault(require(\"vant/es/toast\"));\n\nrequire(\"vant/es/icon/style\");\n\nvar _icon = _interopRequireDefault(require(\"vant/es/icon\"));\n\nrequire(\"vant/es/field/style\");\n\nvar _field = _interopRequireDefault(require(\"vant/es/field\"));\n\nrequire(\"vant/es/picker/style\");\n\nvar _picker = _interopRequireDefault(require(\"vant/es/picker\"));\n\nrequire(\"vant/es/datetime-picker/style\");\n\nvar _datetimePicker = _interopRequireDefault(require(\"vant/es/datetime-picker\"));\n\nrequire(\"vant/es/cell-group/style\");\n\nvar _cellGroup = _interopRequireDefault(require(\"vant/es/cell-group\"));\n\nrequire(\"vant/es/cell/style\");\n\nvar _cell = _interopRequireDefault(require(\"vant/es/cell\"));\n\nrequire(\"vant/es/nav-bar/style\");\n\nvar _navBar = _interopRequireDefault(require(\"vant/es/nav-bar\"));\n\nrequire(\"vant/es/popup/style\");\n\nvar _popup = _interopRequireDefault(require(\"vant/es/popup\"));\n\nrequire(\"vant/es/button/style\");\n\nvar _button = _interopRequireDefault(require(\"vant/es/button\"));\n\nrequire(\"vant/es/pagination/style\");\n\nvar _pagination = _interopRequireDefault(require(\"vant/es/pagination\"));\n\nvar _vue = _interopRequireDefault(require(\"vue\"));\n\nvar _index = _interopRequireDefault(require(\"@/directive/permission/index.js\"));\n\nvar _permission = _interopRequireDefault(require(\"@/utils/permission\"));\n\nvar _orderList = require(\"@/api/orderList\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// 权限判断指令\n// 权限判断函数\n_vue.default.use(_pagination.default);\n\n_vue.default.use(_button.default);\n\n_vue.default.use(_popup.default);\n\n_vue.default.use(_navBar.default);\n\n_vue.default.use(_cell.default);\n\n_vue.default.use(_cellGroup.default);\n\n_vue.default.use(_datetimePicker.default);\n\n_vue.default.use(_picker.default);\n\n_vue.default.use(_field.default);\n\n_vue.default.use(_icon.default);\n\n_vue.default.use(_toast.default);\n\n_vue.default.use(_actionSheet.default);\n\n_vue.default.use(_search.default);\n\nvar _default = {\n  name: \"system-role\",\n  directives: {\n    permission: _index.default\n  },\n  data: function data() {\n    return {\n      list: [],\n      usernameInput: \"\",\n      usefulValue: \"\",\n      usefulOptions: [{\n        value: \"1\",\n        label: \"是\"\n      }, {\n        value: \"0\",\n        label: \"否\"\n      }],\n      usefulColumns: [\"是\", \"否\"],\n      formLabelWidth: \"120px\",\n      dialogTableVisible: false,\n      currentPage: 1,\n      //当前页\n      mobileCurrentPage: 1,\n      pagesizes: [100, 200, 500],\n      //单页最大显示条数\n      pagesize: 100,\n      //单页内条数\n      listTotal: 0,\n      //总数\n      device: \"\",\n      mobileSearchShow: false,\n      mobileSearchButtonLoading: false,\n      searchButtonLoading: false,\n      tableMaxHeight: 0,\n      addDialogVisible: false,\n      updateDialogVisible: false,\n      form: {\n        checkList: [],\n        name: \"\"\n      },\n      updateForm: {\n        checkList: [],\n        username: \"\",\n        name: \"\",\n        password: \"\",\n        telephone: \"\",\n        mode: \"\"\n      },\n      updatePermissionList: [],\n      listLoading: false,\n      multipleSelection: [],\n      updateId: \"\",\n      treeData: [],\n      defaultProps: {\n        children: \"children\",\n        label: \"name\"\n      },\n      updateTreeData: [],\n      pageJumpIndex: 1,\n      nameMobileValue: \"\"\n    };\n  },\n  created: function created() {\n    this.getList();\n    this.device = this.$store.state.app.device;\n    this.getHeight();\n  },\n  computed: {\n    deviceVal: function deviceVal() {\n      return this.$store.state.app.device;\n    }\n  },\n  watch: {\n    deviceVal: function deviceVal(newVal, oldVal) {\n      this.device = newVal;\n    }\n  },\n  methods: {\n    checkPermission: _permission.default,\n    // 获取数据\n    getList: function getList() {\n      var _this = this;\n\n      this.listLoading = true;\n      var searchList = [];\n      var paramObj = {\n        page: this.currentPage,\n        rows: this.pagesize\n      };\n      this.usernameInput ? paramObj.name = name : \"\";\n      (0, _orderList.getRoleList)(paramObj).then(function (res) {\n        var tableList = res.data.rows;\n        tableList.forEach(function (tableItem) {\n          var id = tableItem.id,\n              name = tableItem.name;\n          var orderItem = {\n            id: id,\n            name: name\n          };\n          searchList.push(orderItem);\n        });\n        _this.list = searchList;\n      });\n      setTimeout(function () {\n        _this.listLoading = false;\n      }, 1000);\n    },\n    //表格高度自适应\n    getHeight: function getHeight() {\n      var otherHeight = this.device == \"desktop\" ? 250 : 200;\n      this.tableMaxHeight = window.innerHeight - otherHeight;\n    },\n    // 页面条数切换\n    handleSizeChange: function handleSizeChange(val) {\n      this.pagesize = val;\n      this.getList();\n    },\n    //选择表格当前页数\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.currentPage = val;\n      this.getList();\n    },\n    // 选择改变\n    handleSelectionChange: function handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    // 搜索\n    handleSearch: function handleSearch() {\n      this.searchButtonLoading = true;\n      this.getList();\n      this.searchButtonLoading = false;\n    },\n    // 新增\n    handleAdd: function handleAdd() {\n      var _this2 = this;\n\n      (0, _orderList.addRoleInquired)().then(function (res) {\n        _this2.treeData = res.data;\n      });\n      this.addDialogVisible = true;\n    },\n    // 权限选择变化时\n    handlePermisionCheck: function handlePermisionCheck(current, status) {\n      this.form.checkList = status.checkedKeys;\n    },\n    // 取消新增\n    handleAddCancel: function handleAddCancel() {\n      this.addDialogVisible = false;\n    },\n    // 验证新增\n    addVerify: function addVerify() {\n      return true;\n    },\n    // 确认新增\n    handleAddConfirm: function handleAddConfirm() {\n      var _this3 = this;\n\n      if (!this.addVerify()) return;\n      this.listLoading = true;\n      var name = this.form.name;\n      var functionId = this.form.checkList.join(\",\");\n      (0, _orderList.addRole)({\n        functionId: functionId,\n        name: name\n      }).then(function (res) {\n        if (res.status === 200) {\n          _this3.getList();\n\n          _this3.$message({\n            type: \"success\",\n            message: \"添加用户成功\"\n          });\n        } else {\n          _this3.$message.error(\"添加失败\");\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n      this.listLoading = false;\n      this.addDialogVisible = false;\n    },\n    // 更新\n    handleUpdata: function handleUpdata(rows) {\n      var _this4 = this;\n\n      (0, _orderList.updateRoleInquired)({\n        id: rows.id\n      }).then(function (res) {\n        _this4.updateId = rows.id;\n        _this4.updateForm.name = res.data.role.name;\n        _this4.updateForm.checkList = res.data.functiona;\n        _this4.updateTreeData = res.data.functionList;\n      });\n      this.updateDialogVisible = true;\n    },\n    // 权限选择变化时\n    handleUpdatePermisionCheck: function handleUpdatePermisionCheck(current, status) {\n      this.updateForm.checkList = status.checkedKeys;\n    },\n    // 取消更新\n    handleUpdateCancel: function handleUpdateCancel() {\n      this.updateDialogVisible = false;\n    },\n    // 验证更新\n    updateVerify: function updateVerify() {\n      return true;\n    },\n    // 确认更新\n    handleUpdateConfirm: function handleUpdateConfirm() {\n      var _this5 = this;\n\n      if (!this.updateVerify()) {\n        return;\n      }\n\n      this.listLoading = true;\n      var id = this.updateId;\n      var name = this.updateForm.name;\n      var functionId = this.updateForm.checkList.join(\",\");\n      (0, _orderList.updateRole)({\n        id: id,\n        functionId: functionId,\n        name: name\n      }).then(function (res) {\n        if (res.status === 200) {\n          _this5.getList();\n\n          _this5.$message({\n            type: \"success\",\n            message: \"更新用户成功\"\n          });\n        } else {\n          _this5.$message.error(\"更新失败\");\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n      this.listLoading = false;\n      this.updateDialogVisible = false;\n    },\n    // 删除\n    handleDelete: function handleDelete(rows) {\n      var _this6 = this;\n\n      this.$confirm(\"此操作将永久删除该角色, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        _this6.listLoading = true;\n        (0, _orderList.deleteRole)({\n          id: rows.id\n        }).then(function (res) {\n          if (res.status === 200) {\n            _this6.getList();\n\n            _this6.$message({\n              type: \"success\",\n              message: \"删除角色成功\"\n            });\n          } else {\n            _this6.$message.error(\"删除失败\");\n          }\n        });\n        _this6.listLoading = false;\n      }).catch(function () {\n        _this6.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n    // 批量删除\n    handleDeleteSelect: function handleDeleteSelect() {\n      var _this7 = this;\n\n      this.$confirm(\"此操作将永久删除该角色, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        if (_this7.multipleSelection.length === 0) {\n          _this7.$message.error(\"未选择数据\");\n\n          return;\n        }\n\n        var ids = [];\n\n        _this7.multipleSelection.forEach(function (selectItem) {\n          ids.push(selectItem.id);\n        });\n\n        var idsStr = ids.join(\",\");\n        (0, _orderList.deleteSelectRole)({\n          ids: idsStr\n        }).then(function (res) {\n          if (res.status === 200) {\n            _this7.getList();\n\n            _this7.$message({\n              type: \"success\",\n              message: \"批量删除角色成功\"\n            });\n          } else {\n            _this7.$message.error(\"删除失败\");\n          }\n        });\n      }).catch(function () {\n        _this7.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n\n    /* 移动端事件 */\n    // 获取数据\n    getMobileList: function getMobileList() {\n      var _this8 = this;\n\n      this.listLoading = true;\n      var searchList = [];\n      var paramObj = {\n        page: this.mobileCurrentPage,\n        rows: this.pagesize\n      };\n      this.nameMobileValue ? paramObj.name = this.nameMobileValue : \"\";\n      (0, _orderList.getRoleList)(paramObj).then(function (res) {\n        console.log(res);\n        _this8.listTotal = res.data.total;\n        var tableList = res.data.rows;\n        tableList.forEach(function (tableItem) {\n          var id = tableItem.id,\n              name = tableItem.name;\n          var orderItem = {\n            id: id,\n            name: name\n          };\n          searchList.push(orderItem);\n        });\n        _this8.list = searchList;\n      });\n      setTimeout(function () {\n        _this8.listLoading = false;\n      }, 1000);\n    },\n    // 搜索\n    handleSearchMobile: function handleSearchMobile() {\n      if (!this.mobileSearchShow) {\n        this.mobileSearchShow = !this.mobileSearchShow;\n      }\n    },\n    // 取消搜索\n    handleSearchMobileCancel: function handleSearchMobileCancel() {\n      if (this.mobileSearchShow) {\n        this.mobileSearchShow = !this.mobileSearchShow;\n      }\n    },\n    // 确认搜索\n    handleMobileSearch: function handleMobileSearch() {\n      this.mobileSearchButtonLoading = true;\n      this.getMobileList();\n      this.mobileSearchButtonLoading = false;\n      this.mobileSearchShow = false;\n    },\n    // 清空所选\n    handleSearchMobileClearAll: function handleSearchMobileClearAll() {\n      this.nameMobileValue = \"\";\n    },\n    // 分页器改变\n    handlePageChange: function handlePageChange() {\n      this.getMobileList();\n    },\n    // 限制页面跳转输入框只能输入数字\n    jumpPageInput: function jumpPageInput() {\n      this.pageJumpIndex = this.pageJumpIndex.replace(/[^\\d]/g, \"\");\n    },\n    // 跳转指定页面\n    handleJumpPage: function handleJumpPage() {\n      var jumpPage = parseInt(this.pageJumpIndex);\n      if (jumpPage == this.mobileCurrentPage) return;\n\n      if (jumpPage > Math.ceil(this.listTotal / this.pagesize)) {\n        jumpPage = Math.ceil(this.listTotal / this.pagesize);\n      }\n\n      if (jumpPage < 1) {\n        jumpPage = 1;\n      }\n\n      this.pageJumpIndex = jumpPage;\n      this.mobileCurrentPage = jumpPage;\n      this.getMobileList();\n    }\n  }\n};\nexports.default = _default;",null]}